<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<th:block th:replace="fragments/commonHeader"></th:block>
</head>
<body>
	<section class="notice">
	  	<div class="page-title">
	        <div class="container">
	            <h3>게시판</h3>
	            <div class="search-wrap">
	        		<button type="button" class="btn btn-dark" style="float:right;width:108px;height:40px;" onclick="boardPopup();">입력</button>
	        	</div>
	        </div>    
	    </div>

	    <!-- board seach area -->
	    <div id="board-search">
	        <div class="container">
	            <div class="search-window">
	                <!-- <form action="./selectBoardList"> -->
	                    <div class="search-wrap">
	                        <label for="search" class="blind">공지사항 내용 검색</label>
	                        <input id="keyword" type="search" name="keyword" placeholder="검색어를 입력해주세요." value="">
	                        <button type="button" class="btn btn-dark" onclick="selectList();">검색</button>
	                    </div>
	                <!-- </form> -->
	            </div>
	        </div>
	    </div>
	    
	    <div id="grid" style="width:1350px; height:800px; margin:0 auto;"></div>
	</section>
</body>
<script th:inline="javascript">
var grid;
var data;

$(function(){
	grid = new tui.Grid({
	    el: document.getElementById('grid'),
	    scrollX: false,
	    scrollY: false,
	    rowHeight:30,
	    columnOptions: {
	        minWidth: 180
	    },
	    columns: [
	      {
	          header: '순번',
	          name: 'idx',
	          width: 'auto',
	          align:'center'
	      },
	      {
	    	  header: '제목',
	          name: 'title',
	          align:'center',
	          width: 'auto'
	      },
	      {
	          header: '내용',
	          name: 'content',
	          align:'center'
	      }
	    ]
	});
	
	//selectList(grid);
	
	
	grid.on('click', (evt) => {
		var rowKey = evt["rowKey"];
		var rowObj = evt.instance.store.viewport.rows[rowKey].valueMap;
		var idx = rowObj["idx"]["value"];
		
		if(evt.columnName == "title"){
			boardPopup(idx);	
		}
	});
	
});

function selectList(){
	$.ajax({
	    url: '/board/selectBoardList',
	    async: true,
	    type: 'GET',
	    data: {
	    	keyword: $("#keyword").val(),
	    },
	    dataType: 'json',
	    success: function(data) {
	    	grid.resetData(data);
	    	setTimeout(
	    		grid.refreshLayout(), 
	    	1000);
	    	
	    },
	    error: function(jqXHR) {
	    	console.log("error"); 
	    },
	    complete: function(jqXHR) {
	    	console.log("complete"); 
	    }
	});
};

function boardPopup(idx){
	var popupWidth = 700;
	var popupHeight = 850;
	
	var popupX = (window.screen.width / 2) - (popupWidth / 2);
	// 만들 팝업창 width 크기의 1/2 만큼 보정값으로 빼주었음

	var popupY= (window.screen.height / 2) - (popupHeight / 2);
	// 만들 팝업창 height 크기의 1/2 만큼 보정값으로 빼주었음
	
	var url = "/board/boardModal";
	if(idx != undefined){
		url += "?idx=" + idx;
	}
	
	
	var popupConfig = 'status=no, height=' + popupHeight + ',width=' + popupWidth + ',left=' + popupX + ',top=' + popupY;
	var win = window.open(url, "신규 POPUP", popupConfig);
}
</script>

</html>